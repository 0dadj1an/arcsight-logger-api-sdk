# Arcsight Logger REST library

This is a python library to interact with the REST API that is offered on the Arcsight Logger

### Installation

Install library with pip ([You can install pip here](https://pip.pypa.io/en/stable/installing/ "Google's Homepage"))
```sh
$ pip install arcsightrest
```
Import the library
```python
import arcsightrest
```
### Different functions
#### Setting the location of the ArcSight Logger
Set the TARGET to the ip or hostname of the Arcsight logger
```python
arcsightrest.ArcsightLogger.TARGET = 'https://IPADDRESS:9000'
```
#### Logging in
Logging in. Storing of the token is done by the library, The last
option is optional, if this is True it will ignore all SSL warnings (
if you have not imported the SSL certificate, this is default to False
```python
arcsightrest.ArcsightLogger('USERNAME', 'PASSWORD', True)
```
#### Searching
The search function will return 2 values, first the search_id that has
been set for the search, and the HTTP content/response. You can add a
time delay for the search, if you want the search time to be longer
or shorter than the default (2 hours), this can be done by adding how
long (in timedelta format) the search should take, from the moment it
is executed.

Example, this will use one day:
```python
search_id, response = arcsight.search('QUERY', 1)
```
Default 2 hours:
```python
search_id, response = arcsight.search('QUERY')
```
#### Histogram
Returns data you can use to display a histogram (a column chart with no gap between columns) of the
event distribution over time of an already searched time range
```python
histogram(search_id)
```
#### Search status
There is two functions to check the search status, one function will check if the search is complete, the other will check the current status, and wait for it to be complete.

Waiting for the search to complete:
```python
arcsight.wait(search_id)
```
Just checking the current status:
```python
arcsight.search_complete(search_id)
```
#### Collecting the data from a search
The events function is what will return the actual events that is
generated by the search, in a normal JSON format:
```python
arcsight.events(search_id)
```
Custom JSON format:
```python
arcsight.events(search_id, True)
```
#### Stopping a search
There is two ways to stop the currently running search
Stop, stops the search operation but keeps the search session so that the search results can be narrowed
down later.
```python
data = arcsight.stop(search_id)
```
Close, stops the execution of the search and clears the search session data from the server.
```python
data = arcsight.close(search_id)
```
### Example script
```python
def searchfunction():
    # Define target
    arcsightrest.ArcsightLogger.TARGET = 'https://10.10.10.10:9000'
    # Logging in
    arcsight = arcsightrest.ArcsightLogger('USERNAME', 'PASSWORD', True)
    # Grabs the search_id of the search, and the response to see if the
    # search is started.
    search_id, response = arcsight.search('_deviceGroup in ["Logger Internal Event Device"]')
    print response
    # Waits for the search to complete, then checks what wait returns
    # (should be that the search is complete)
    wait = arcsight.wait(search_id)
    print wait
    # Gather the data from the started search, and prints all data returned
    data = arcsight.events(search_id)
    print data
    # Closes the search when i have the data needed, and checks the response
    close = arcsight.close(search_id)
    print close
```
